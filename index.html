<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammar Quiz - Will/Won't/Might/Might Not</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            max-width: 800px;
            width: 100%;
            padding: 40px;
            backdrop-filter: blur(5px);
        }

        h1 { color: #4a59bd; text-align: center; margin-bottom: 30px; font-size: 2em; }
        .timer { text-align: center; font-size: 1.5em; color: #e74c3c; margin-bottom: 20px; font-weight: bold; }

        .progress-container {
            width: 100%;
            height: 30px;
            background: #ecf0f1;
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
            display: flex;
        }

        .progress-bar-correct { height: 100%; background: linear-gradient(90deg, #27ae60, #2ecc71); transition: width 0.3s ease; z-index: 2; }
        .progress-bar-incorrect { height: 100%; background: linear-gradient(90deg, #c0392b, #e74c3c); transition: width 0.3s ease; z-index: 1; }
        .progress-text { position: absolute; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #2c3e50; font-weight: bold; z-index: 3; pointer-events: none; }

        .question-text { font-size: 1.25em; margin-bottom: 20px; line-height: 1.6; color: #2c3e50; background: #f0f3ff; padding: 20px; border-left: 5px solid #667eea; border-radius: 5px; }
        .options { display: grid; gap: 15px; }
        .option { background: #f8f9fa; border: 2px solid #dee2e6; border-radius: 10px; padding: 15px 20px; cursor: pointer; transition: all 0.2s ease; font-size: 1.1em; }
        .option:hover { background: #e9ecef; border-color: #667eea; transform: translateX(5px); }
        .option.selected { background: #667eea; color: white; border-color: #667eea; }

        .nav-buttons { display: flex; justify-content: flex-end; margin-top: 30px; }
        button { background: #667eea; color: white; border: none; padding: 12px 30px; border-radius: 8px; font-size: 1em; cursor: pointer; transition: all 0.3s ease; font-weight: bold; }
        button:hover { background: #5568d3; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        button:disabled { background: #95a5a6; cursor: not-allowed; transform: none; }

        .results { text-align: center; display: none; }
        .score { font-size: 3em; color: #27ae60; margin: 20px 0; font-weight: bold; }
        .score.fail { color: #e74c3c; }
        .start-screen { text-align: center; }
        .form-group { margin: 25px 0; text-align: left; }
        .form-group input { width: 100%; padding: 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 1em; }
        .quiz-content { display: none; }
    </style>
</head>
<body>

    <audio id="soundCorrect" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="soundIncorrect" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>

    <div class="container">
        <h1>Grammar: Future Modals</h1>
        
        <div class="start-screen" id="startScreen">
            <p>Will/Won't (Certainty) vs Might/Might Not (Possibility)</p>
            <div class="form-group">
                <label>Student Name:</label>
                <input type="text" id="studentName" placeholder="Enter your name..." required>
            </div>
            <button onclick="startQuiz()">Start Random Quiz</button>
        </div>

        <div class="quiz-content" id="quizContent">
            <div class="timer" id="timer">Time: 5:00</div>
            <div class="progress-container">
                <div class="progress-bar-correct" id="progressBarCorrect"></div>
                <div class="progress-bar-incorrect" id="progressBarIncorrect"></div>
                <div class="progress-text" id="progressText">0/10</div>
            </div>
            <div id="questionContainer">
                <div class="question-text" id="questionText"></div>
                <div class="options" id="optionsContainer"></div>
            </div>
            <div class="nav-buttons">
                <button id="nextBtn" onclick="nextQuestion()">Next</button>
                <button id="submitBtn" onclick="submitQuiz()" style="display: none;">Submit Quiz</button>
            </div>
        </div>

        <div class="results" id="results">
            <h2>Quiz Results</h2>
            <div class="score" id="finalScore"></div>
            <p id="resultMessage"></p>
            <p style="margin-top:10px; color:#666;">Saving your score to the teacher's sheet...</p>
            <button onclick="location.reload()" style="margin-top:20px;">Restart Quiz</button>
        </div>
    </div>

<script>
const fullBank = [
    {q: "I've already bought the tickets. We ___ definitely see the show tonight.", options: ["will", "won't", "might", "might not"], correct: "will"},
    {q: "The sun always rises in the East. It ___ rise there tomorrow morning.", options: ["will", "won't", "might", "might not"], correct: "will"},
    {q: "I promise I ___ tell anyone your secret. You can trust me 100%.", options: ["will", "won't", "might", "might not"], correct: "won't"},
    {q: "He is a vegetarian. He ___ eat the beef burger you ordered.", options: ["will", "won't", "might", "might not"], correct: "won't"},
    {q: "If you don't study at all, I'm sure you ___ pass this difficult exam.", options: ["will", "won't", "might", "might not"], correct: "won't"},
    {q: "I've decided! I ___ study engineering at university next year. I'm certain.", options: ["will", "won't", "might", "might not"], correct: "will"},
    {q: "The battery is at 0%. The phone ___ turn off in a few seconds.", options: ["will", "won't", "might", "might not"], correct: "will"},
    {q: "Stop! If you touch that hot plate, you ___ definitely burn your hand.", options: ["will", "won't", "might", "might not"], correct: "will"},
    {q: "He hates loud music. He ___ come to the rock concert with us.", options: ["will", "won't", "might", "might not"], correct: "won't"},
    {q: "The bank is closed. They ___ open until tomorrow morning.", options: ["will", "won't", "might", "might not"], correct: "won't"},
    {q: "I haven't decided yet. I ___ go to Japan for my holiday.", options: ["will", "won't", "might", "might not"], correct: "might"},
    {q: "The sky is a bit grey. It ___ rain later, but I'm not sure.", options: ["will", "won't", "might", "might not"], correct: "might"},
    {q: "She's feeling a little tired, so she ___ come to the gym tonight.", options: ["will", "won't", "might", "might not"], correct: "might not"},
    {q: "Perhaps we'll see them at the park. They ___ be there playing football.", options: ["will", "won't", "might", "might not"], correct: "might"},
    {q: "I'm not sure if I'm hungry. I ___ eat a big dinner tonight.", options: ["will", "won't", "might", "might not"], correct: "might not"},
    {q: "I haven't decided. I ___ buy a new car, or I might just repair my old one.", options: ["will", "won't", "might", "might not"], correct: "might"},
    {q: "There's a lot of traffic. We ___ arrive on time for the movie, we aren't sure.", options: ["will", "won't", "might", "might not"], correct: "might not"},
    {q: "Check the fridge. There ___ be some milk left, but I think we drank it all.", options: ["will", "won't", "might", "might not"], correct: "might"},
    {q: "It's possible she is sleeping. She ___ answer her phone if we call.", options: ["will", "won't", "might", "might not"], correct: "might not"},
    {q: "The test was hard. I ___ get an A, but I hope so.", options: ["will", "won't", "might", "might not"], correct: "might not"},
    {q: "Maybe they're at home. Their car is in the drive, but I ___ be right.", options: ["will", "won't", "might", "might not"], correct: "might"},
    {q: "We ___ visit our grandparents if the weather is nice, but we haven't decided.", options: ["will", "won't", "might", "might not"], correct: "might"},
    {q: "I'm not sure about the color. I ___ choose the blue one.", options: ["will", "won't", "might", "might not"], correct: "might"}
];

let currentQuestions = [];
let currentQuestionIndex = 0;
let answers = [];
let timeLeft = 300;
let timerInterval;
let studentName = "";

function startQuiz() {
    studentName = document.getElementById('studentName').value.trim();
    if(!studentName) return alert("Please enter your name");
    
    currentQuestions = fullBank.sort(() => 0.5 - Math.random()).slice(0, 10);
    answers = new Array(10).fill(null);
    
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('quizContent').style.display = 'block';
    displayQuestion();
    startTimer();
}

function startTimer() {
    timerInterval = setInterval(() => {
        timeLeft--;
        let min = Math.floor(timeLeft/60);
        let sec = timeLeft%60;
        document.getElementById('timer').textContent = `Time: ${min}:${sec.toString().padStart(2, '0')}`;
        if(timeLeft <= 0) submitQuiz();
    }, 1000);
}

function displayQuestion() {
    const q = currentQuestions[currentQuestionIndex];
    document.getElementById('questionText').innerHTML = `<strong>Question ${currentQuestionIndex+1}:</strong><br>${q.q}`;
    const container = document.getElementById('optionsContainer');
    container.innerHTML = '';
    
    q.options.forEach(opt => {
        const btn = document.createElement('div');
        btn.className = 'option' + (answers[currentQuestionIndex] === opt ? ' selected' : '');
        btn.textContent = opt;
        btn.onclick = () => {
            const isCorrect = opt === q.correct;
            document.getElementById(isCorrect ? 'soundCorrect' : 'soundIncorrect').play();
            answers[currentQuestionIndex] = opt;
            displayQuestion();
        };
        container.appendChild(btn);
    });
    
    // UI Logic for Next/Submit
    document.getElementById('nextBtn').style.display = currentQuestionIndex === 9 ? 'none' : 'block';
    document.getElementById('submitBtn').style.display = currentQuestionIndex === 9 ? 'block' : 'none';
    updateProgress();
}

function updateProgress() {
    let correct = 0, incorrect = 0, answered = 0;
    answers.forEach((a, i) => {
        if(a) {
            answered++;
            if(a === currentQuestions[i].correct) correct++; else incorrect++;
        }
    });
    document.getElementById('progressBarCorrect').style.width = (correct * 10) + '%';
    document.getElementById('progressBarIncorrect').style.width = (incorrect * 10) + '%';
    document.getElementById('progressText').textContent = `${answered}/10 Answers`;
}

function nextQuestion() { if(currentQuestionIndex < 9) { currentQuestionIndex++; displayQuestion(); } }

function submitQuiz() {
    clearInterval(timerInterval);
    let score = 0;
    answers.forEach((a, i) => { if(a === currentQuestions[i].correct) score++; });
    
    const timeTakenSeconds = 300 - timeLeft;
    const minutes = Math.floor(timeTakenSeconds / 60);
    const seconds = timeTakenSeconds % 60;
    const formattedTime = `${minutes}:${seconds.toString().padStart(2, '0')}`;

    document.getElementById('quizContent').style.display = 'none';
    document.getElementById('results').style.display = 'block';
    const scoreEl = document.getElementById('finalScore');
    scoreEl.textContent = `${score}/10 (${score * 10}%)`;
    scoreEl.className = score >= 7 ? 'score' : 'score fail';
    document.getElementById('resultMessage').textContent = score >= 7 ? "Great job, " + studentName + "! ðŸŒŸ" : "Keep practicing, " + studentName + "! ðŸ“š";

    sendToGoogleSheets(score * 10, score, formattedTime);
}

function sendToGoogleSheets(percent, correctCount, time) {
    const scriptURL = 'https://script.google.com/macros/s/AKfycbw-xgofjZSPhtE1cPN0AsPhN9-V8aLWmzMyjEQmqWIcKSLBmJGLAlCFueZ6ueQkyZc/exec';
    
    const formData = new FormData();
    formData.append('name', studentName);
    formData.append('score', percent + "%");
    formData.append('correctAnswers', correctCount);
    formData.append('timeTaken', time);
    formData.append('date', new Date().toLocaleString());

    fetch(scriptURL, { 
        method: 'POST', 
        body: formData,
        mode: 'no-cors' 
    })
    .then(() => console.log('Data successfully sent to Sheets!'))
    .catch(error => console.error('Error sending data:', error.message));
}
</script>
</body>
</html>
